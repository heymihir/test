SELECT 'A' AS table,
       LISTAGG(code, ',') WITHIN GROUP (ORDER BY code) AS code
FROM (
    SELECT DISTINCT IHDCPT AS code
    FROM STG_ME_HIE_IPDCMSP_RETN
    WHERE IHDCPT IN ('PEB','APG','CGA','TEB','FNG','REB','SDN','DPF',
                     'GTE','GOV','CGB','SDG','SDC','BBD','LEG','YPG',
                     'SBT','YFG','YCG')
)
UNION ALL
SELECT 'B' AS table,
       LISTAGG(code, ',') WITHIN GROUP (ORDER BY code) AS code
FROM (
    SELECT DISTINCT IIAPTY AS code
    FROM STG_ME_HIE_IPBLMSP_RETN
    WHERE IIAPTY IN ('PEB','APG','CGA','TEB','FNG','REB','SDN','DPF',
                     'GTE','GOV','CGB','SDG','SDC','BBD','LEG','YPG',
                     'SBT','YFG','YCG')
)
UNION ALL
SELECT 'C' AS table,
       LISTAGG(code, ',') WITHIN GROUP (ORDER BY code) AS code
FROM (
    SELECT DISTINCT LEAPTY AS code
    FROM STG_ME_HIE_EPALSFP_RETN
    WHERE LEAPTY IN ('PEB','APG','CGA','TEB','FNG','REB','SDN','DPF',
                     'GTE','GOV','CGB','SDG','SDC','BBD','LEG','YPG',
                     'SBT','YFG','YCG')
);
