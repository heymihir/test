def clean_ytd_column(col):
    # Extract a two-digit year from the column name
    year_match = re.search(r"(\d{2})", col)
    year = year_match.group(1) if year_match else ''
    
    # Remove words like 'avg' and 'ytd' and any token that contains digits
    tokens = [word for word in col.split() 
              if word.lower() not in ('avg', 'ytd') and not re.search(r'\d', word)]
    
    # Combine the remaining tokens as the product name
    product_name = " ".join(tokens)
    
    # Format as "YTD {product_name} {year}"
    return f"YTD {product_name} {year}".strip()

df_updated.columns = [
    clean_ytd_column(col) if 'ytd' in col.lower() else col 
    for col in df_updated.columns
]
