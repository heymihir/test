import pandas as pd
import numpy as np

def transform(df):
    df = df.copy()
    for col in df.columns:
        if pd.api.types.is_numeric_dtype(df[col]):
            df[col] = df[col].round(3)
        elif pd.api.types.is_string_dtype(df[col]):
            df[col] = df[col].str.upper()
    return df

dm = transform(df_manual)
dc = transform(df_code)
merged = dm.merge(dc, on="CUST_ID.1", suffixes=('_m', '_c'))
match_rates = {}
for col in dm.columns:
    if col != "CUST_ID.1":
        match_rates[col] = (merged[f"{col}_m"] == merged[f"{col}_c"]).mean() * 100
print(pd.DataFrame(match_rates, index=["Match Rate"]))
