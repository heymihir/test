# Format the top (header) row with header_format (which has white font)
for col_idx, col_name in enumerate(pivot_gainers.columns):
    worksheet.write(0, col_idx, col_name, header_format)

# Format the data rows, applying total_row_format for the "Grand Total" row
for row_idx, row in enumerate(pivot_gainers.itertuples(index=False), start=1):
    if "Grand Total" in str(row[0]):
        for col_idx, value in enumerate(row):
            worksheet.write(row_idx, col_idx, value, total_row_format)
    else:
        for col_idx, value in enumerate(row):
            worksheet.write(row_idx, col_idx, value, default_format)
