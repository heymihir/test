
# Define a function that renames the column if it matches the pattern
def rename_column(col):
    # Only modify columns that contain 'EOP' and not 'MTD'
    if 'EOP' in col and 'MTD' not in col:
        # Using regex to capture the parts after 'EOP'
        # Pattern: starts with 'EOP', then whitespace, then product name, then the rest (date, etc.)
        pattern = r'^(EOP)\s+(.+)$'
        # Replace with 'EOP total {rest}'
        new_col = re.sub(pattern, r'\1 total \2', col)
        return new_col
    return col

# Rename the columns in-place
df_base_data.rename(columns=lambda x: rename_column(x), inplace=True)

# Print the new columns
print(df_base_data.columns.tolist())
