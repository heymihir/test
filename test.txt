        number_format = workbook.add_format({
            'num_format': '#,##0.00;-#,##0.00;"-"',  # handles 0 and blank
            'align': 'right'
        })

        # Step 1: Fill missing CUST_ID.1 with cust_id
df['CUST_ID.1'] = df['CUST_ID.1'].fillna(df['cust_id'])

# Step 2: Remove 'inhsbc' (case-insensitive) and insert '-' after 3 characters
df['CUST_ID.1'] = (
    df['CUST_ID.1']
    .str.replace('inhsbc', '', case=False)
    .str.upper()
    .apply(lambda x: x[:3] + '-' + x[3:] if len(x) > 3 else x)
)
