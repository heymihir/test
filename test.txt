import pandas as pd

# Assume 'merged' is your existing DataFrame
cols = list(merged.columns)
offset = 0  # to adjust for newly inserted columns
for i in range(1, len(cols), 2):
    # Compute equality check between the previous column and the current column
    eq = merged[cols[i-1]] == merged[cols[i]]
    # Insert the new column after the current column (account for offset)
    merged.insert(i + offset + 1, f"{cols[i-1]}_eq_{cols[i]}", eq)
    offset += 1

# Now, 'merged' contains the additional equality columns.
print(merged.head())
