def process_id(id_str):
    # Remove 'INHSBC' if it appears at the beginning (case-insensitive)
    if id_str.upper().startswith("INHSBC"):
        id_str = id_str[len("INHSBC"):]
    # Insert a dash after the third character (if there are at least 4 characters)
    if len(id_str) > 3:
        return id_str[:3] + '-' + id_str[3:]
    else:
        return id_str

# Create a mask for rows where CUST_ID.1 is NA and cust_id is not NA.
mask = df['CUST_ID.1'].isna() & df['cust_id'].notna()

# Process and assign only those rows.
df.loc[mask, 'CUST_ID.1'] = df.loc[mask, 'cust_id'].apply(process_id)
